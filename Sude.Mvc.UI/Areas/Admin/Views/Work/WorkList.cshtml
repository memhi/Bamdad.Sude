@using Sude.Dto.DtoModels.Result
@using Sude.Dto.DtoModels.Work
@model ResultSetDto<IEnumerable<WorkDetailDtoModel>>
 
     <div class="input-group">
        <input type="text" name="message" placeholder="Type words ..." class="form-control">
        <span class="input-group-btn">
            <button type="submit" class="btn btn-primary btn-flat">جستجو</button>
        </span>
    </div>

     
 


<div class="row">
    <div class="col-xs-12">
        <div class="box">
            <div class="box-header">
                <h3 class="box-title">فهرست  کسب و کارها</h3>

                <div class="box-tools">
                     
                            <a id="btnAdd" class="btn btn-block btn-success">کسب و کار جدید</a>
               
                </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive no-padding">
                <table class="table table-hover">
                    <tr>
                        <td>#</td>
                        <th>عنوان</th>
                        <th>نوع</th>
                        <th>توضیحات</th>
                        <th>عملیات</th>

                    </tr>
                    @{ 
                    @foreach (var item in Model.Data)
                    {
                        int i = 1;
                <tr id="tr_@item.WorkTypeId" role="row" class="odd">
                    <td>@(i++)</td>
                    <td>@item.Title</td>
                    <td>@item.WorkTypeName</td>
                    <td>@item.Desc</td>
                    <td>
                        <button class="btn btn-warning btn-sm" onclick="ShowEditWorkPop('@item.WorkId')">ویرایش</button>
                        <button class="btn btn-danger btn-sm" onclick="DeleteWork('@item.WorkId')">حذف</button>
                        <button class="btn btn-info btn-sm" onclick="ShowNewPageModalDetailWork('@item.WorkId')">جزئیات</button>
                    </td>
                </tr>
                    }}
                </table>
            </div>
            <!-- /.box-body -->
        </div>
        <!-- /.box -->
    </div>


    </div>



    <script>
        $("#btnAdd").click(function () {
            $("#WorkView").load("Work/Add");
        });


        function DeleteWork(workId) {

            swal.fire({
                title: 'حذف کسب و کار',
                text: "کاربر گرامی از حذف کسب و کار مطمئن هستید؟",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#7cacbe',
                cancelButtonColor: '#d33',
                confirmButtonText: 'بله ، کسب و کار حذف شود',
                cancelButtonText: 'خیر'
            }).then((result) => {
                if (result.value) {

                    $.ajax({
                        url: "Work/Delete/" + workId,
                        type: "Get",
                        success: function (result) {
                            if (result.isSucceed == true) {
                                swal.fire(
                                    'موفق!',
                                    result.message,
                                    'success'
                                ).then(function (isConfirm) {
                                    $("#tr_" + workId).addClass("danger");
                                    $("#tr_" + workId).hide('slow');
                                    //location.reload();
                                });
                                $("#workView").load("Work/List");
                            }
                            else {

                                swal.fire(
                                    'هشدار!',
                                    result.message,
                                    'warning'
                                );

                            }
                        },
                        error: function (request, status, error) {
                            alert(request.responseText);
                        }

                    });

                }
            })
        }



        function ShowEditWorkPop(workId) {
            $.get("Work/Edit/" + workId, function (result) {

                $("#myModal").modal('show');
                $("#myModalLabel").html("ویرایش کسب و کار");
                $("#myModalBody").html(result);
            });
        }




        function ShowEditWork(workId) {
            $("#WorkView").load("Work/Edit/" + workId);

        }


        function ShowNewPageModalDetailWork(workId) {


            $.get("Work/Detail/" + workId, function (result) {

                $("#myModal").modal('show');
                $("#myModalLabel").html("جزئیات کسب و کار");
                $("#myModalBody").html(result);
            });
        }

    </script>
